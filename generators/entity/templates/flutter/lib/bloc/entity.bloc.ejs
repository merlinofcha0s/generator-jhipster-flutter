<%_
const baseName = context.baseName;
const entityInstance = context.entityInstance;
const entityFileName = context.entityFileName;
const entityClassPlural = context.entityClassPlural;
const entityClassHumanized = context.entityClassHumanized;
const entityClassPluralHumanizedLowered = context.entityClassPluralHumanizedLowered;
_%>
import 'dart:async';
import 'package:bloc/bloc.dart';
import 'package:flutter/foundation.dart';
import 'package:equatable/equatable.dart';
import 'package:<%= baseName %>/entities/<%= entityFileName %>/<%= entityFileName %>_model.dart';
import 'package:<%= baseName %>/entities/<%= entityFileName %>/<%= entityFileName %>_repository.dart';

part '<%= entityFileName %>_events.dart';
part '<%= entityFileName %>_state.dart';

class <%= entityClassHumanized %>Bloc extends Bloc<<%= entityClassHumanized %>Event, <%= entityClassHumanized %>State> {
  final <%= entityClassHumanized %>Repository _<%= entityFileName %>Repository;

  <%= entityClassHumanized %>Bloc({@required <%= entityClassHumanized %>Repository <%= entityFileName %>Repository}) : assert(<%= entityFileName %>Repository != null),
        _<%= entityFileName %>Repository = <%= entityFileName %>Repository, super(const <%= entityClassHumanized %>State());

  @override
  void onTransition(Transition<<%= entityClassHumanized %>Event, <%= entityClassHumanized %>State> transition) {
    super.onTransition(transition);
  }

  @override
  Stream<<%= entityClassHumanized %>State> mapEventToState(<%= entityClassHumanized %>Event event) async* {
    if (event is InitList) {
      yield* onInitList(event);
    }
  }

  Stream<<%= entityClassHumanized %>State> onInitList(InitList event) async* {
    yield state.copyWith(<%= entityFileName %>StatusUI: <%= entityClassHumanized %>StatusUI.loading);
    List<<%= entityClassHumanized %>> <%= entityClassPluralHumanizedLowered %> = await _<%= entityFileName %>Repository.getAll<%= entityClassPlural %>();
    yield state.copyWith(<%= entityClassPluralHumanizedLowered %>: <%= entityClassPluralHumanizedLowered %>, <%= entityFileName %>StatusUI: <%= entityClassHumanized %>StatusUI.done);
  }
}